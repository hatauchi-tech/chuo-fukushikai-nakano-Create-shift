# **AIシフト作成アプリ 要件定義書 (Ver. 2.0)**

## **1\. はじめに**

### **1.1 プロジェクトの背景**

現在、介護施設における職員のシフト作成は、各ユニットのリーダーが手作業で行っている。複雑な勤務ルール（夜勤の配置、連勤制限、有資格者の必須配置など）を考慮しながら、職員から提出される休み希望を反映させる必要があり、その調整業務は属人的かつ膨大な時間を要している。この状況は、リーダーの負担増を招き、本来注力すべきケア業務や職員のマネジメント業務を圧迫する一因となっている。

### **1.2 プロジェクトの目的**

本プロジェクトは、Gemini APIを活用したシフト管理アプリを開発し、シフト作成業務を自動化することを目的とする。

* **定量的目標:** リーダーの月次シフト作成工数を 現状の21時間から5時間へ削減 する（約76%削減）。  
* **定性的目標:**  
  * 属人化しているシフト作成業務の標準化と効率化を実現する。  
  * 創出された時間を、ケアの質の向上や職員とのコミュニケーションといった、より付付加価値の高い業務に充てる。  
  * 複雑なルールを遵守した公平なシフトを自動生成することで、職員の満足度を向上させる。

## **2\. プロジェクトの概要**

### **2.1 システム概要**

本システムは、Google Apps Script (GAS) 上で動作するWebブラウザアプリケーション（SPA方式）である。職員は自身のPCから休み希望を提出し、ユニットリーダーはそれらの希望と事前に定義された勤務ルールに基づき、Gemini APIを用いてシフト案を自動生成する。生成されたシフト案は画面上で手動修正が可能であり、完成したシフト表はPDF形式でGoogleドライブに出力できる。

### **2.2 システム利用イメージ**

1. **【職員】** ログイン画面で所属グループ・氏名を選択し、パスワードを入力してログインする。  
2. **【職員】** Web画面上のカレンダーから、翌月の休みたい日を選択し提出する。  
3. **【リーダー】** 締め日後、管理画面から「シフト自動生成」ボタンをクリックする。  
4. **【システム】** 全職員の休み希望と勤務ルール（M\_ルール）に基づき、Gemini APIがシフト案を自動生成する。  
5. **【リーダー】** 生成されたシフト案を確認し、必要に応じて画面上でプルダウンメニューを用いて手動で修正する。  
6. **【リーダー】** 完成したシフト表をPDF形式でダウンロードし、既存の業務フローに沿って職員へ共有する。

### **2.3 スコープ（対象範囲）**

#### **スコープ内**

* 職員マスターの管理機能（登録・更新・削除）  
* 勤務ルールの管理機能（AIが参照）  
* イベントカレンダーの共有機能  
* 職員による休み希望の提出機能  
* Gemini APIによるシフト案の自動生成機能  
* リーダーによるシフト案の手動修正機能（プルダウン式）  
* 完成したシフト表のPDF出力機能（Googleドライブへ保存）  
* 簡易ログイン機能（スプレッドシートのパスワードと照合）

#### **スコープ外（やらないこと）**

* 主任による承認ワークフロー機能  
* タイムカードシステムや給与計算システムとのデータ自動連携  
* 職員ごとの勤務希望（早出がいい、など）の受付機能  
  * *「休み希望」「勤務不可」のみを受け付ける。*

## **3\. 機能要件**

### **3.1 機能一覧**

| 大項目 | 機能名 | 概要 |
| :---- | :---- | :---- |
| 認証 | ログイン機能 | 職員がグループ・氏名・パスワードでログインする。 |
| シフト管理 | **シフト自動生成機能** | 職員の休み希望とM\_ルールに基づき、Gemini APIが1ヶ月分のシフト案を自動で生成する。 |
|  | **AIフィードバック機能** | AIがルールを適用できなかった場合、その旨を文章でリーダーに通知する。 |
|  | シフト手動修正機能 | AIが生成したシフト案を、リーダーが画面上でプルダウン選択式で直感的に修正できる。 |
|  | シフト表出力機能 | 完成したシフト表をPDF形式（yyyy年MM月シフト表\_グループX.pdf）でGoogleドライブに出力する。 |
| 希望・情報管理 | 休み希望提出機能 | 職員がWeb画面のカレンダーから休みたい日を提出できる。 |
|  | イベントカレンダー機能 | ユニット会議などの共有事項を登録・閲覧できる。登録されたイベントは希望提出画面のカレンダーにも表示される（所属グループ・ユニットに基づきフィルタリング）。 |
| マスタ管理 | マスタ管理機能 | 各種マスタ（職員、シフト、ルール）の登録・更新・削除を行う。 |

## **4\. 非機能要件**

| 項目 | 要件 |
| :---- | :---- |
| **性能** | 職員60名、1ヶ月分のシフト自動生成処理（Gemini APIの呼び出しとGASの処理）が、**6分以内**に完了すること。（技術検証にて実現可能性を確認済み） |
| **ユーザビリティ** | AIによる自動生成を主とし、手動修正はプルダウン選択方式で直感的に行えるようにする。 |
| **セキュリティ** | ログイン認証は、M\_職員 テーブルに格納されたパスワード情報と、ログイン画面での入力値を照合して行う。 |
| **信頼性** | シフト生成処理が実行時間上限（6分）を超えた場合、処理を安全に中断し、リーダーにエラーが発生した旨を通知する。途中までのデータでシフトが作成されることはない。 |

## **5\. 技術構成・制約条件**

| 項目 | 仕様・前提条件 |
| :---- | :---- |
| **技術基盤** | **Google Apps Script (GAS)** 上で構築・運用する。 |
| **データベース** | **Google スプレッドシート** を使用する。 |
| **AIエンジン** | **Gemini API** を利用する。 |
| **フロントエンド** | **HTML (SPA方式)** \+ **Tailwind CSS** で構築する。 |
| **アーキテクチャ** | 保守性向上のため、**MVC風のコード構造**（Model/View/Controller分離）を採用する。 |
| **実行環境** | 職員は各ユニットに設置された共用PCのWebブラウザからシステムを利用する。 |
| **設定管理** | 以下の情報は **スクリプトプロパティ** で管理し、コード本体には記述しない。 ・Google スプレッドシートID ・Google ドライブID（PDF出力先） ・Gemini APIキー ・**Gemini API モデル名** |
| **開発・保守** | テスト、デバッグがスムーズになるよう、実行ログやコンソールに処理状況が残るようにする。 |

## **6\. 【APPENDIX】データベース設計（ファイルレイアウト Ver 1.1）**

* T\_シフト希望詳細 から冗長な「従業員」列を削除。（反映済み）  
* M\_職員 の「グループ」は EnumList（複数選択可）とする。  
  * 運用ルール: シフト作成はグループ単位で行う。対象グループ外のグループにのみ所属する職員は、そのシフト作成には含まれない。

### **テーブル一覧**

| テーブル名 | テーブル役割 |
| :---- | :---- |
| T\_シフト表 | 出力したシフト表（PDF）の履歴管理 |
| T\_シフト表詳細 | 生成されたシフト（日ごと・人ごと）のデータ |
| T\_シフト希望 | 職員からの休み希望（親データ） |
| T\_シフト希望詳細 | 休み希望日（子データ） |
| T\_イベント | 共有イベント（会議など） |
| M\_職員 | 職員マスタ |
| M\_シフト | 勤務シフトのマスタ（早出、日勤など） |
| M\_ルール | AIが参照するシフト作成ルール |

### **詳細レイアウト**

#### **T\_シフト表**

| 列名 | カラムタイプ | 備考 |
| :---- | :---- | :---- |
| シフト表ID | Text | Key |
| 出力者 | Ref (M\_職員) |  |
| 年月 | Date | yyyy/MM/01 |
| グループ | EnumList | 1,2,3,4,5,6（カンマ区切り） |
| ファイルパス | File | Googleドライブに格納したPDFファイルのパス |

#### **T\_シフト表詳細**

| 列名 | カラムタイプ | 備考 |
| :---- | :---- | :---- |
| 履歴ID | Text | Key |
| シフト表ID | Ref (T\_シフト表) | Key |
| 日付 | Date | yyyy/MM/dd |
| 従業員名 | Ref (M\_職員) |  |
| 勤務シフト | Ref (M\_シフト) |  |

#### **T\_シフト希望**

| 列名 | カラムタイプ | 備考 |
| :---- | :---- | :---- |
| シフト希望ID | Text | Key |
| 提出者 | Ref (M\_職員) |  |
| 提出日 | Date | yyyy/MM/dd |
| 特記事項 | Text |  |

#### **T\_シフト希望詳細**

| 列名 | カラムタイプ | 備考 |
| :---- | :---- | :---- |
| シフト希望詳細ID | Text | Key |
| シフト希望ID | Ref (T\_シフト希望) |  |
| 日付 | Date | yyyy/MM/dd |

#### **T\_イベント**

| 列名 | カラムタイプ | 備考 |
| :---- | :---- | :---- |
| イベントID | Text | Key |
| 登録日時 | DateTime | yyyy/MM/dd HH:mm:ss |
| 登録者 | Ref (M\_職員) |  |
| イベント日 | Date | yyyy/MM/dd |
| グループ | EnumList | 1,2,3,4,5,6（カンマ区切り） |
| ユニット | Enum | M\_職員の「ユニット」のユニーク |
| 内容 | LongText |  |

#### **M\_職員**

| 列名 | カラムタイプ | 備考 |
| :---- | :---- | :---- |
| 従業員ID | Text | Key |
| 所属 | Text |  |
| 役職 | Text |  |
| グループ | EnumList | 1,2,3,4,5,6（カンマ区切り） |
| ユニット | Text |  |
| 氏名 | Text |  |
| 喀痰吸引資格者 | Boolean | TRUE,FALSE |
| 勤務配慮 | Text |  |
| 権限 | Enum | 管理者,一般 |
| 雇用形態 | Enum | 常勤,派遣 |
| 有効 | Boolean | TRUE,FALSE |
| PW | Text | ログイン用パスワード |

#### **M\_シフト**

| 列名 | カラムタイプ | 備考 |
| :---- | :---- | :---- |
| シフトID | Text | Key |
| シフト名 | Text |  |
| 開始時間 | Time | HH:mm |
| 終了時間 | Time | HH:mm |

#### **M\_ルール**

| 列名 | カラムタイプ | 備考 |
| :---- | :---- | :---- |
| ルールID | Text | Key |
| ルール名 | Text |  |
| 内容 | LongText | Gemini APIに渡す自然言語のルール |
| 重要度 | Enum | 最高,高,中,低,最低 |

